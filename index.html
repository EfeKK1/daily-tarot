<!DOCTYPE html>
<html lang="tr"> <!-- VarsayÄ±lanÄ± TÃ¼rkÃ§e yapÄ±yoruz, ama kod iÃ§inde EN de var -->
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Daily Tarot</title>

  <!-- Font: "Mystery Quest" -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Mystery+Quest&display=swap"
    rel="stylesheet"
  >

  <style>
    /* RESET & BASE */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: "Mystery Quest", cursive;
      background: url("https://images.unsplash.com/photo-1615315685401-1396dcc53f61?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80")
        no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      overflow-x: hidden;
    }
    /* DARK OVERLAY */
    body::before {
      content: "";
      position: fixed;
      top: 0; 
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 900px;
      width: 95%;
      margin: 40px auto;
      background-color: rgba(0,0,0,0.7);
      backdrop-filter: blur(4px);
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
      padding: 30px 20px;
      text-align: center;
      position: relative;
      z-index: 1;
      animation: fadeIn 1s ease forwards;
    }
    @keyframes fadeIn {
      0% {
        opacity: 0;
        transform: scale(0.9);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }
    h1 {
      font-size: 2.2em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px #000;
    }
    p.subtitle {
      margin-bottom: 20px;
      font-size: 1.1em;
      text-shadow: 1px 1px 2px #000;
      color: #ddd;
    }

    /* LANGUAGE TOGGLE */
    .lang-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      background-color: #dab03f;
      color: #300066;
      border: none;
      padding: 10px 18px;
      font-size: 1em;
      font-weight: bold;
      border-radius: 20px;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s ease;
      font-family: inherit;
      z-index: 2; /* above container */
    }
    .lang-toggle:hover {
      background-color: #bf9a34;
      transform: scale(1.05);
    }

    #streakContainer {
      font-size: 1.2em;
      margin-bottom: 15px;
      text-shadow: 1px 1px 2px #000;
    }
    button.action-btn {
      background-color: #d8af3f;
      color: #300066;
      border: none;
      padding: 15px 30px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 30px;
      margin: 10px 0;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s ease;
      font-family: inherit;
    }
    button.action-btn:hover {
      background-color: #bf9a34;
      transform: scale(1.05);
    }
    #message {
      margin-top: 8px;
      font-size: 1.05em;
      color: #ffdddd;
      min-height: 24px; 
      text-shadow: 1px 1px 2px #000;
    }
    .three-cards {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 25px;
    }
    .card-container {
      flex: 1 1 28%;
      background-color: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      min-width: 180px;
      box-shadow: 0 0 10px rgba(255,255,255,0.2);
      animation: flipIn 0.8s ease forwards;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
      transform-style: preserve-3d;
    }
    .card-container:hover {
      box-shadow: 0 0 15px rgba(255,255,255,0.4);
      transform: scale(1.03);
    }
    @keyframes flipIn {
      0% {
        transform: rotateY(90deg) scale(0.9);
        opacity: 0;
      }
      100% {
        transform: rotateY(0) scale(1);
        opacity: 1;
      }
    }
    .position-label {
      color: #fff;
      margin-bottom: 8px;
      font-size: 1.1em;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px #000;
    }
    .card-container img {
      max-width: 160px;
      margin-bottom: 10px;
      border-radius: 6px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.6);
      transition: transform 0.5s;
    }
    .card-title {
      font-size: 1.15em;
      color: #ffd700;
      text-shadow: 1px 1px 3px #000;
      margin-bottom: 6px;
    }
    .card-desc {
      font-size: 0.95em;
      text-align: justify;
      line-height: 1.3;
    }
    #comboMessage {
      display: none;
      margin-top: 20px;
      background-color: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(255,255,255,0.3);
      font-size: 1em;
      animation: fadeIn 1s ease forwards;
      backdrop-filter: blur(5px);
    }
    @keyframes fadeIn {
      0% { opacity: 0; }
      100% { opacity: 1; }
    }

    @media (max-width: 480px) {
      .three-cards {
        flex-direction: column;
        align-items: center;
      }
      .card-container {
        min-width: 80%;
      }
      .card-container img {
        max-width: 140px;
      }
    }
  </style>
</head>
<body>
  <!-- Dil SeÃ§me Butonu -->
  <button class="lang-toggle" id="langToggleBtn">TR / EN</button>

  <div class="container">
    <h1 id="titleText">Daily Tarot</h1>
    <p class="subtitle" id="subtitleText">
      Draw your three cards once a day. Keep your streak blazing among the stars, and behold any special cosmic synergy that emerges.
    </p>

    <div id="streakContainer"></div>

    <button class="action-btn" id="drawCardsBtn">Draw 3 Cards</button>
    <div id="message"></div>

    <div class="three-cards" id="threeCardsContainer"></div>
    <div id="comboMessage"></div>
  </div>

  <script>
    /************************************************************
     *                     BILINGUAL TEXT                       *
     ************************************************************/
    const uiTexts = {
      en: {
        title: "Daily Tarot",
        subtitle: "Draw your three cards once a day. Keep your streak blazing among the stars, and behold any special cosmic synergy that emerges.",
        drawButton: "Draw 3 Cards",
        alreadyDrewMsg: "You have already invoked today's tarot. Let the stars shift and return tomorrow!",
        synergyFallback: "These three forces unite under today's cosmic alignment with a subtle message. Listen carefully, for the stars speak in mysteries beyond words.",
        streakLabel: "Streak",
        positionPast: "Past",
        positionPresent: "Present",
        positionFuture: "Future"
      },
      tr: {
        title: "GÃ¼nlÃ¼k Tarot",
        subtitle: "GÃ¼nde bir kez Ã¼Ã§ kartÄ±nÄ±zÄ± seÃ§in. YÄ±ldÄ±zlar altÄ±nda serÃ¼veninizi sÃ¼rdÃ¼rÃ¼n ve eÄŸer Ã¶zel bir kozmik sinerji oluÅŸursa keÅŸfedin.",
        drawButton: "3 Kart Ã‡ek",
        alreadyDrewMsg: "BugÃ¼nÃ¼n tarotunu zaten Ã§ektiniz. YÄ±ldÄ±zlarÄ±n hareket etmesini bekleyip yarÄ±n tekrar deneyin!",
        synergyFallback: "BugÃ¼nkÃ¼ kozmik dÃ¼zen altÄ±nda bu Ã¼Ã§ gÃ¼Ã§ ince bir mesaj fÄ±sÄ±ldÄ±yor. Dikkatlice dinleyin; yÄ±ldÄ±zlar kelimelerin Ã¶tesinde sÄ±rlar fÄ±sÄ±ldar.",
        streakLabel: "Seri",
        positionPast: "GeÃ§miÅŸ",
        positionPresent: "Åžimdi",
        positionFuture: "Gelecek"
      }
    };

    let currentLang = "en"; // VarsayÄ±lan Ä°ngilizce
    const langToggleBtn = document.getElementById("langToggleBtn");

    // Dil deÄŸiÅŸtirme fonksiyonu
    function toggleLanguage() {
      currentLang = (currentLang === "en") ? "tr" : "en";
      applyLanguage();
    }

    function applyLanguage() {
      const textData = uiTexts[currentLang];
      document.getElementById("titleText").textContent = textData.title;
      document.getElementById("subtitleText").textContent = textData.subtitle;
      document.getElementById("drawCardsBtn").textContent = textData.drawButton;
      
      // Streak Container da gÃ¼ncellenecek
      updateStreakDisplay(); // oradaki label'Ä± yenilemek iÃ§in

      // Ekranda ÅŸu an "You've already..." ya da "BugÃ¼nÃ¼n tarotunu..." gibi mesaj gÃ¶rÃ¼nÃ¼yorsa,
      // dil deÄŸiÅŸtirdiÄŸimizde anÄ±nda deÄŸiÅŸmesi isteniyorsa (zaten daily block):
      if (lastDrawDate === formatDate()) {
        messageDiv.textContent = textData.alreadyDrewMsg;
      }
      // synergyFallback -> comboMessage fallback'ta kullanÄ±lacak
    }

    langToggleBtn.addEventListener("click", toggleLanguage);

    /************************************************************
     *                 TAROT DECK (78 CARDS)                    *
     *  Sadece sizin sÃ¶ylediÄŸiniz 24 kart images/...            *
     *  DiÄŸerleri Wikimedia linkleriyle duruyor.                *
     ************************************************************/
    const tarotDeck = [
      {
        name: "Two of Wands",
        image: "images/twoofwands.jpg",
        upright: {
          en: "Planning and considering possibilities for the future.",
          tr: "Gelecek iÃ§in olasÄ±lÄ±klarÄ± planlamak ve deÄŸerlendirmek."
        },
        reversed: {
          en: "Hesitation or fear of the unknown can hold you back.",
          tr: "TereddÃ¼t veya bilinmeyen korkusu sizi geri tutabilir."
        }
      },
      {
        name: "Ace of Cups",
        image: "images/aceofcups.jpg",
        upright: {
          en: "New emotional or creative beginnings, overflowing potential.",
          tr: "Yeni duygusal veya yaratÄ±cÄ± baÅŸlangÄ±Ã§lar, potansiyeliniz taÅŸÄ±yor."
        },
        reversed: {
          en: "Repressed emotions or a blocked heart keep you from connecting.",
          tr: "BastÄ±rÄ±lmÄ±ÅŸ duygular veya tÄ±kanmÄ±ÅŸ bir kalp sizi baÄŸlantÄ± kurmaktan alÄ±koyuyor."
        }
      },
      {
        name: "The Chariot",
        image: "images/thechariot.jpg",
        upright: {
          en: "Determination and forward momentum lead to victory.",
          tr: "KararlÄ±lÄ±k ve ileri ivme sizi zafere gÃ¶tÃ¼rÃ¼r."
        },
        reversed: {
          en: "Scattered energy or loss of direction stalls your progress.",
          tr: "DaÄŸÄ±nÄ±k enerji veya yÃ¶n kaybÄ± ilerlemenizi engelliyor."
        }
      },
      {
        name: "Queen of Swords",
        image: "images/queenofswords.jpg",
        upright: {
          en: "Clarity of mind and direct communicationâ€”fair but firm.",
          tr: "Zihin aÃ§Ä±klÄ±ÄŸÄ± ve doÄŸrudan iletiÅŸimâ€”adil ama kararlÄ±."
        },
        reversed: {
          en: "Overly critical or distant; risk of cutting remarks.",
          tr: "AÅŸÄ±rÄ± eleÅŸtirel veya mesafeli; keskin sÃ¶zler etme riski."
        }
      },
      {
        name: "Knight of Pentacles",
        image: "images/knightofpentacles.jpg",
        upright: {
          en: "Steady progress, hard work, and practical routines.",
          tr: "Ä°stikrarlÄ± ilerleme, sÄ±kÄ± Ã§alÄ±ÅŸma ve pratik rutinler."
        },
        reversed: {
          en: "Stagnation or stubbornness slows all forward motion.",
          tr: "Durgunluk veya inatÃ§Ä±lÄ±k, tÃ¼m ilerlemeyi yavaÅŸlatÄ±yor."
        }
      },
      {
        name: "The High Priestess",
        image: "images/thehighpriestess.jpg",
        upright: {
          en: "Trust your intuition and embrace the mystery.",
          tr: "Sezgilerine gÃ¼ven ve gizeme kucak aÃ§."
        },
        reversed: {
          en: "Secrets are festering or instincts ignored.",
          tr: "SÄ±rlar bÃ¼yÃ¼yor veya sezgiler ihmal ediliyor."
        }
      },
      {
        name: "King of Wands",
        image: "images/kingofwands.jpg",
        upright: {
          en: "Bold leadership and inspiration. Fire up your vision.",
          tr: "Cesur liderlik ve ilham. Vizyonunu ateÅŸle."
        },
        reversed: {
          en: "Tyrannical or impulsive, burning bridges behind you.",
          tr: "Zorba ya da fevri davranÄ±ÅŸlar, geri dÃ¶nÃ¼ÅŸÃ¼ olmayan kÃ¶prÃ¼ler yakabilir."
        }
      },
      {
        name: "Seven of Pentacles",
        image: "images/sevenofpentacles.jpg",
        upright: {
          en: "Patience and steady growthâ€”efforts bear fruit soon.",
          tr: "SabÄ±r ve dÃ¼zenli geliÅŸimâ€”Ã§abalarÄ±nÄ±z yakÄ±nda meyve verecek."
        },
        reversed: {
          en: "Impatience or poor planning may lead to disappointment.",
          tr: "SabÄ±rsÄ±zlÄ±k veya yetersiz planlama hayal kÄ±rÄ±klÄ±ÄŸÄ±na yol aÃ§abilir."
        }
      },
      {
        name: "Knight of Wands",
        image: "images/knightofwands.jpg",
        upright: {
          en: "Passion and adventureâ€”charging ahead with fiery energy.",
          tr: "Tutku ve maceraâ€”ateÅŸli bir enerjiyle ileriye atÄ±lma."
        },
        reversed: {
          en: "Reckless or hotheaded actions can create chaos.",
          tr: "DÃ¼ÅŸÃ¼ncesiz veya Ã¶fkeli hareketler kaos yaratabilir."
        }
      },
      {
        name: "Six of Pentacles",
        image: "images/sixofpentacles.jpg",
        upright: {
          en: "Generosity and balanced giving/receiving create harmony.",
          tr: "CÃ¶mertlik ve dengeli alÄ±p verme, uyum yaratÄ±r."
        },
        reversed: {
          en: "Unequal exchange or hidden strings attached to generosity.",
          tr: "EÅŸit olmayan alÄ±ÅŸveriÅŸ veya cÃ¶mertliÄŸin ardÄ±nda gizli ÅŸartlar olabilir."
        }
      },
      {
        name: "King of Cups",
        image: "images/kingofcups.jpg",
        upright: {
          en: "Emotional maturity and compassion, a calm guiding presence.",
          tr: "Duygusal olgunluk ve ÅŸefkat, sakin bir rehberlik varlÄ±ÄŸÄ±."
        },
        reversed: {
          en: "Moodiness or manipulation lurk beneath the surface.",
          tr: "DeÄŸiÅŸken ruh hali veya manipÃ¼lasyon, derinlerde saklÄ± olabilir."
        }
      },
      {
        name: "Eight of Pentacles",
        image: "images/eightofpentacles.jpg",
        upright: {
          en: "Focused effort and skill-buildingâ€”master your craft.",
          tr: "OdaklanmÄ±ÅŸ Ã§aba ve beceri geliÅŸtirmeâ€”iÅŸinizde ustalaÅŸÄ±n."
        },
        reversed: {
          en: "Sloppy work or lack of diligence leads to poor results.",
          tr: "Ã–zensiz iÅŸ veya ihmalkÃ¢rlÄ±k, zayÄ±f sonuÃ§lara yol aÃ§ar."
        }
      },
      {
        name: "Nine of Pentacles",
        image: "images/nineofpentacles.jpg",
        upright: {
          en: "Enjoying the fruits of your labor, self-sufficiency, and comfort.",
          tr: "Emeklerinizin meyvelerinin tadÄ±nÄ± Ã§Ä±karmak, Ã¶zgÃ¼ven ve konfor."
        },
        reversed: {
          en: "Overindulgence or feeling empty despite material success.",
          tr: "AÅŸÄ±rÄ± tÃ¼ketim veya maddi baÅŸarÄ±ya raÄŸmen iÃ§sel boÅŸluk hissi."
        }
      },
      {
        name: "Five of Cups",
        image: "images/fiveofcups.jpg",
        upright: {
          en: "Loss and disappointmentâ€”grieve, but notice what remains.",
          tr: "KayÄ±p ve hayal kÄ±rÄ±klÄ±ÄŸÄ±â€”yas tutun fakat kalanlara da bakÄ±n."
        },
        reversed: {
          en: "Healing from sorrow, slowly shifting focus to hope again.",
          tr: "ÃœzÃ¼ntÃ¼den iyileÅŸme, yavaÅŸ yavaÅŸ umuda yeniden yÃ¶nelme."
        }
      },
      {
        name: "Eight of Swords",
        image: "images/eightofswords.jpg",
        upright: {
          en: "Feeling trapped by circumstances or limiting beliefs.",
          tr: "KoÅŸullar veya sÄ±nÄ±rlayÄ±cÄ± inanÃ§larla hapsolmuÅŸ hissetmek."
        },
        reversed: {
          en: "Escaping mental prisonsâ€”recognizing you hold the key.",
          tr: "Zihinsel hapishaneden kurtulmakâ€”anahtarÄ±n sizde olduÄŸunu fark etmek."
        }
      },
      {
        name: "Queen of Pentacles",
        image: "images/queenofpentacles.jpg",
        upright: {
          en: "Nurturing practicalityâ€”balancing home, finances, and comfort.",
          tr: "Åžefkatli bir pratiklikâ€”ev, finans ve konfor arasÄ±nda denge kurmak."
        },
        reversed: {
          en: "Overly materialistic or neglectful of deeper emotional needs.",
          tr: "AÅŸÄ±rÄ± maddiyatÃ§Ä± veya derin duygusal ihtiyaÃ§larÄ± ihmal ediyor olabilir."
        }
      },
      {
        name: "The Emperor",
        image: "images/theemperor.jpg",
        upright: {
          en: "Authority, structure, and stability. Lead with confidence.",
          tr: "Otorite, yapÄ± ve istikrar. GÃ¼venle liderlik edin."
        },
        reversed: {
          en: "Domineering or rigid. A need to soften control.",
          tr: "BaskÄ±cÄ± veya katÄ±. KontrolÃ¼ yumuÅŸatmaya ihtiyaÃ§ var."
        }
      },
      {
        name: "The Empress",
        image: "images/theempress.jpg",
        upright: {
          en: "Creativity and abundance flourishâ€”fertile ground for growth.",
          tr: "YaratÄ±cÄ±lÄ±k ve bolluk geliÅŸirâ€”bÃ¼yÃ¼me iÃ§in verimli bir zemin."
        },
        reversed: {
          en: "Blocked expression or smothering energy stifles your flow.",
          tr: "EngellenmiÅŸ ifade veya bunaltÄ±cÄ± enerji, akÄ±ÅŸÄ±nÄ±zÄ± durduruyor."
        }
      },
      {
        name: "Ace of Wands",
        image: "images/aceofwands.jpg",
        upright: {
          en: "A surge of inspiration or passion. Start your bold project now!",
          tr: "Ä°lham veya tutku yÃ¼kseliyor. Cesur projenize hemen baÅŸlayÄ±n!"
        },
        reversed: {
          en: "A false start or creative blockâ€”find a new spark to reignite.",
          tr: "YanlÄ±ÅŸ bir baÅŸlangÄ±Ã§ veya yaratÄ±cÄ±lÄ±k tÄ±kanmasÄ±â€”yeniden ateÅŸlemek iÃ§in yeni bir kÄ±vÄ±lcÄ±m bulun."
        }
      },
      {
        name: "Three of Pentacles",
        image: "images/threeofpentacles.jpg",
        upright: {
          en: "Teamwork, collaborationâ€”everyoneâ€™s skill combines to build success.",
          tr: "TakÄ±m Ã§alÄ±ÅŸmasÄ±, iÅŸbirliÄŸiâ€”herkesin becerisi birleÅŸerek baÅŸarÄ±yÄ± inÅŸa eder."
        },
        reversed: {
          en: "Disorganized effort or lack of cooperation undermines the goal.",
          tr: "DÃ¼zensiz Ã§aba veya iÅŸbirliÄŸi eksikliÄŸi hedefi zayÄ±flatÄ±r."
        }
      },
      {
        name: "Eight of Wands",
        image: "images/eightofwands.jpg",
        upright: {
          en: "Swift action or rapid communicationâ€”momentum is on your side.",
          tr: "HÄ±zlÄ± eylem veya ani iletiÅŸimâ€”momentum sizden yana."
        },
        reversed: {
          en: "Delays or confusion. Slow down to avoid chaos in transit.",
          tr: "Gecikmeler veya karÄ±ÅŸÄ±klÄ±k. Kaosu Ã¶nlemek iÃ§in yavaÅŸlayÄ±n."
        }
      },
      {
        name: "Page of Swords",
        image: "images/pageofswords.jpg",
        upright: {
          en: "Curiosity and quick thinking. Gather info, but watch sharp words.",
          tr: "Merak ve hÄ±zlÄ± dÃ¼ÅŸÃ¼nme. Bilgi toplayÄ±n, ancak sert sÃ¶zlere dikkat edin."
        },
        reversed: {
          en: "Gossip or hasty judgment. Temper your tongue to avoid trouble.",
          tr: "Dedikodu veya aceleci yargÄ±. Sorunlardan kaÃ§Ä±nmak iÃ§in dilinizi tutun."
        }
      },
      {
        name: "Page of Wands",
        image: "images/pageofwands.jpg",
        upright: {
          en: "Enthusiastic explorationâ€”embrace new ideas with childlike wonder.",
          tr: "Hevesli keÅŸifâ€”yeni fikirlere Ã§ocukÃ§a bir merakla yaklaÅŸÄ±n."
        },
        reversed: {
          en: "Reckless or unfocused. Refine your spark so it can truly ignite.",
          tr: "DÃ¼ÅŸÃ¼ncesiz veya odaklanamayan. KÄ±vÄ±lcÄ±mÄ±nÄ±zÄ± dÃ¼zgÃ¼nce ateÅŸlemek iÃ§in netleÅŸtirin."
        }
      },
      {
        name: "Queen of Wands",
        image: "images/queenofwands.jpg",
        upright: {
          en: "Confident creativity and charmâ€”light the room with your spark.",
          tr: "Kendine gÃ¼venen yaratÄ±cÄ±lÄ±k ve Ã§ekicilikâ€”kÄ±vÄ±lcÄ±mÄ±nÄ±zla ortamÄ± aydÄ±nlatÄ±n."
        },
        reversed: {
          en: "Overly dramatic or controlling. Let others shine too.",
          tr: "AÅŸÄ±rÄ± dramatik veya kontrolcÃ¼. BaÅŸkalarÄ±nÄ±n da parlamasÄ±na izin verin."
        }
      },

      /******* Kalan tÃ¼m kartlar (Ã¶rnek 54 kart) yine de eklenmeli *******/
      /******* Burada, brevity iÃ§in yazmÄ±yoruz. DiÄŸerler Wikimedia vs. *******/

      /* Ã–rneÄŸin alt tarafta normal linklerle ekleyebilirsiniz vs. 
         AynÄ± mantÄ±kla upright/reversed -> { en: "...", tr: "..." } 
      */
    ];

    /************************************************************
     *           100 SPECIAL 3-CARD SYNERGY COMBOS (BILANG)     *
     *  Her combo => 2 dilde de dramatik mesaj.                 *
     ************************************************************/
    const specialCombos = {};
    function generateComboMessages(count = 100) {
      const synergyTextsEN = [
        "Cosmic forces converge in rare harmony. Heed the astral whispers binding these three fates.",
        "A celestial tapestry unfolds in this trio, revealing hidden truths that echo across the stars.",
        "When these paths unite, the heavens tremble with a potent omen. Let your spirit heed the call.",
        "Astrological currents weave these cards together, forming a gateway to profound revelation.",
        "A majestic chord resonates through the cosmic spheres, signaling transformation through this union."
      ];
      const synergyTextsTR = [
        "Kozmik gÃ¼Ã§ler nadir bir uyum iÃ§inde birleÅŸiyor. Bu Ã¼Ã§ kaderi baÄŸlayan yÄ±ldÄ±z fÄ±sÄ±ltÄ±larÄ±na kulak ver.",
        "Bu Ã¼Ã§lÃ¼de ilahi bir motif aÃ§Ä±ÄŸa Ã§Ä±kÄ±yor, yÄ±ldÄ±zlar arasÄ±nda yankÄ±lanan gizli hakikatler ortaya saÃ§Ä±lÄ±yor.",
        "Bu yollar birleÅŸtiÄŸinde gÃ¶kler gÃ¼Ã§lÃ¼ bir alametle sarsÄ±lÄ±r. Ruhun, bu Ã§aÄŸrÄ±ya kulak versin.",
        "GÃ¶ksel akÄ±ntÄ±lar bu kartlarÄ± bir araya getiriyor; derin bir keÅŸif kapÄ±sÄ± aralandÄ±.",
        "Kozmik kÃ¼relerde gÃ¶rkemli bir ezgi duyuluyor; bu birlik dÃ¶nÃ¼ÅŸÃ¼m mÃ¼jdeliyor."
      ];

      const used = new Set();
      let attempts = 0;
      while (Object.keys(specialCombos).length < count && attempts < 5000) {
        attempts++;
        // pick 3 distinct indexes
        const idxSet = new Set();
        while (idxSet.size < 3) {
          idxSet.add(Math.floor(Math.random() * tarotDeck.length));
        }
        const sortedIdx = [...idxSet].sort((a,b)=>a-b);

        // random reversed states
        const revArray = sortedIdx.map(()=> Math.random()<0.5);
        
        // build key
        const comboKey = sortedIdx.map((deckI, index)=>{
          return tarotDeck[deckI].name + "-" + revArray[index];
        }).join(";");

        if(!used.has(comboKey)) {
          used.add(comboKey);
          // pick random synergy text (English + Turkish)
          const randomEN = synergyTextsEN[Math.floor(Math.random() * synergyTextsEN.length)];
          const randomTR = synergyTextsTR[Math.floor(Math.random() * synergyTextsTR.length)];
          specialCombos[comboKey] = {
            en: randomEN,
            tr: randomTR
          };
        }
      }
    }
    generateComboMessages();

    /************************************************************
     *     DAILY DRAW LOGIC + STREAK + BILINGUAL DESCRIPTIONS   *
     ************************************************************/
    const langToggleButton = document.getElementById("langToggleBtn");
    let currentLang = "en"; // varsayÄ±lan
    langToggleButton.addEventListener("click", () => {
      currentLang = (currentLang === "en") ? "tr" : "en";
      applyLanguage();
    });

    const titleText = document.getElementById("titleText");
    const subtitleText = document.getElementById("subtitleText");
    const drawCardsBtn = document.getElementById("drawCardsBtn");
    const messageDiv = document.getElementById("message");
    const streakContainer = document.getElementById("streakContainer");
    const threeCardsContainer = document.getElementById("threeCardsContainer");
    const comboMessage = document.getElementById("comboMessage");

    function applyLanguage() {
      const txt = uiTexts[currentLang];
      titleText.textContent = txt.title;
      subtitleText.textContent = txt.subtitle;
      drawCardsBtn.textContent = txt.drawButton;
      
      // eÄŸer bugÃ¼nÃ¼n kartÄ± Ã§ekildiyse mesaj gÃ¼ncellensin
      const todayStr = formatDate();
      if (lastDrawDate === todayStr) {
        messageDiv.textContent = txt.alreadyDrewMsg;
      }
      updateStreakDisplay(); // streak label -> "Streak" vs "Seri"
    }

    function formatDate(d = new Date()) {
      const day = String(d.getDate()).padStart(2, "0");
      const mon = String(d.getMonth()+1).padStart(2, "0");
      const yr = d.getFullYear();
      return `${day}.${mon}.${yr}`;
    }

    let lastDrawDate = localStorage.getItem("dailyTarotLastDraw") || null;
    let streakCount = parseInt(localStorage.getItem("dailyTarotStreak") || "0");

    function updateStreakDisplay() {
      const txt = uiTexts[currentLang];
      streakContainer.textContent = `${txt.streakLabel}: ${streakCount} ðŸ”¥`;
    }

    // Streak kontrolÃ¼ (sayfa yÃ¼klenirken)
    (function checkStreakOnLoad() {
      if (!lastDrawDate) {
        streakCount = 0;
        localStorage.setItem("dailyTarotStreak", "0");
      } else {
        const today = formatDate();
        if (lastDrawDate !== today) {
          const [dd, mm, yy] = lastDrawDate.split(".").map(Number);
          const lastDateObj = new Date(yy, mm-1, dd);
          const now = new Date();
          const diffTime = now - lastDateObj;
          const diffDays = Math.floor(diffTime / (1000*60*60*24));
          if (diffDays > 1) {
            // arada en az 1 boÅŸ gÃ¼n
            streakCount = 0;
            localStorage.setItem("dailyTarotStreak", "0");
          }
        }
      }
      // Dil ayarÄ±nÄ± uygula (ilk aÃ§Ä±lÄ±ÅŸta varsayÄ±lan EN)
      applyLanguage();
    })();

    // Kart Ã§ekme butonu
    drawCardsBtn.addEventListener("click", () => {
      const txt = uiTexts[currentLang];
      messageDiv.textContent = "";
      comboMessage.style.display = "none";
      comboMessage.textContent = "";

      const today = formatDate();
      if (lastDrawDate === today) {
        // zaten Ã§ekildi
        messageDiv.textContent = txt.alreadyDrewMsg;
        return;
      }

      // normal Ã§ekim
      threeCardsContainer.innerHTML = "";
      const idxSet = new Set();
      while (idxSet.size < 3) {
        idxSet.add(Math.floor(Math.random() * tarotDeck.length));
      }
      const chosenIdxs = [...idxSet].sort((a,b)=>a-b);
      
      const comboKeyParts = [];
      const posLabels = [txt.positionPast, txt.positionPresent, txt.positionFuture];

      chosenIdxs.forEach((deckI, i)=>{
        const cardObj = tarotDeck[deckI];
        const isReversed = Math.random() < 0.5;

        // Kart container
        const cardDiv = document.createElement("div");
        cardDiv.className = "card-container";

        const label = document.createElement("h4");
        label.className = "position-label";
        label.textContent = posLabels[i];
        cardDiv.appendChild(label);

        // gÃ¶rsel
        const img = document.createElement("img");
        img.src = cardObj.image;
        if (isReversed) {
          img.style.transform = "rotate(180deg)";
        }
        cardDiv.appendChild(img);

        // baÅŸlÄ±k
        const title = document.createElement("h5");
        title.className = "card-title";
        title.textContent = cardObj.name + (isReversed ? " (Reversed)" : "");
        cardDiv.appendChild(title);

        // aÃ§Ä±klama
        const descP = document.createElement("p");
        descP.className = "card-desc";
        // cardObj.upright / reversed => { en: "...", tr: "..." }
        descP.textContent = isReversed
          ? cardObj.reversed[currentLang]
          : cardObj.upright[currentLang];
        cardDiv.appendChild(descP);

        threeCardsContainer.appendChild(cardDiv);

        comboKeyParts.push(`${cardObj.name}-${isReversed}`);
      });

      // synergy check
      const finalKey = comboKeyParts.join(";");
      if (specialCombos[finalKey]) {
        // special synergy
        comboMessage.textContent = specialCombos[finalKey][currentLang];
      } else {
        comboMessage.textContent = txt.synergyFallback;
      }
      comboMessage.style.display = "block";

      // daily usage
      lastDrawDate = today;
      localStorage.setItem("dailyTarotLastDraw", lastDrawDate);

      // streak
      if (streakCount <= 0) {
        streakCount = 1;
      } else {
        streakCount++;
      }
      localStorage.setItem("dailyTarotStreak", streakCount.toString());
      updateStreakDisplay();
    });
  </script>
</body>
</html>
