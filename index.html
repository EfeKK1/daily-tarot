<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily Tarot (No Streak, No Daily Limit)</title>

  <!-- Google Font: Mystery Quest -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Mystery+Quest&display=swap" 
    rel="stylesheet"
  >

  <style>
    /* RESET */
    * {
      box-sizing: border-box;
      margin: 0; padding: 0;
    }
    body {
      font-family: "Mystery Quest", cursive;
      background: url("https://images.unsplash.com/photo-1615315685401-1396dcc53f61?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80")
        no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      overflow-x: hidden;
    }
    /* DARK OVERLAY */
    body::before {
      content: "";
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 900px; width: 95%;
      margin: 40px auto;
      background-color: rgba(0,0,0,0.7);
      backdrop-filter: blur(4px);
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
      padding: 30px 20px;
      text-align: center;
      position: relative; z-index: 1;
      animation: fadeIn 1s ease forwards;
    }
    @keyframes fadeIn {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }

    h1 {
      font-size: 2.2em; margin-bottom: 10px;
      text-shadow: 2px 2px 4px #000;
    }
    p.subtitle {
      margin-bottom: 20px;
      font-size: 1.1em;
      color: #ddd;
      text-shadow: 1px 1px 2px #000;
    }

    /* LANG TOGGLE */
    .lang-toggle {
      position: absolute;
      top: 15px; right: 15px;
      background-color: #dab03f;
      color: #300066;
      border: none;
      padding: 10px 18px;
      font-size: 1em;
      font-weight: bold;
      border-radius: 20px;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s ease;
      font-family: inherit;
      z-index: 2;
    }
    .lang-toggle:hover {
      background-color: #bf9a34;
      transform: scale(1.05);
    }

    /* BUTTONS & MESSAGES */
    button.action-btn {
      background-color: #d8af3f;
      color: #300066;
      border: none;
      padding: 15px 30px;
      font-size: 1.2em;
      font-weight: bold;
      border-radius: 30px;
      margin: 10px 6px;
      cursor: pointer;
      transition: transform 0.3s ease, background-color 0.3s ease;
      font-family: inherit;
    }
    button.action-btn:hover {
      background-color: #bf9a34;
      transform: scale(1.05);
    }

    #message {
      margin-top: 8px;
      font-size: 1.05em;
      color: #ffdddd;
      min-height: 24px; 
      text-shadow: 1px 1px 2px #000;
    }

    /* 3-CARD LAYOUT */
    .three-cards {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-top: 25px;
    }
    .card-container {
      flex: 1 1 28%;
      background-color: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 20px;
      text-align: center;
      min-width: 180px;
      box-shadow: 0 0 10px rgba(255,255,255,0.2);
      animation: flipIn 0.8s ease forwards;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
      transform-style: preserve-3d;
    }
    .card-container:hover {
      box-shadow: 0 0 15px rgba(255,255,255,0.4);
      transform: scale(1.03);
    }
    @keyframes flipIn {
      0% {
        transform: rotateY(90deg) scale(0.9);
        opacity: 0;
      }
      100% {
        transform: rotateY(0) scale(1);
        opacity: 1;
      }
    }
    .position-label {
      color: #fff;
      margin-bottom: 8px;
      font-size: 1.1em;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 1px 1px 2px #000;
    }
    .card-container img {
      max-width: 160px;
      margin-bottom: 10px;
      border-radius: 6px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.6);
      transition: transform 0.5s;
    }
    .card-title {
      font-size: 1.15em;
      color: #ffd700;
      text-shadow: 1px 1px 3px #000;
      margin-bottom: 6px;
    }
    .card-desc {
      font-size: 0.95em;
      text-align: justify;
      line-height: 1.3;
    }

    /* AI READING OUTPUT */
    #aiReadingContainer {
      display: none;
      margin-top: 20px;
      background-color: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(255,255,255,0.3);
      font-size: 1em;
      text-align: justify;
      backdrop-filter: blur(5px);
    }
  </style>
</head>
<body>

  <!-- Dil Seçici Buton -->
  <button class="lang-toggle" id="langToggleBtn">TR / EN</button>

  <div class="container">
    <h1 id="titleText">Daily Tarot (No Streak/Limit)</h1>
    <p class="subtitle" id="subtitleText">
      Draw 3 cards anytime you like, then optionally get an AI interpretation. Test away!
    </p>

    <!-- Butonlar & Mesaj -->
    <div>
      <button class="action-btn" id="drawCardsBtn">Draw 3 Cards</button>
      <button class="action-btn" id="aiReadingBtn" style="display:none;">AI Reading</button>
    </div>
    <div id="message"></div>

    <!-- 3 Kart Yerleşimi -->
    <div class="three-cards" id="threeCardsContainer"></div>

    <!-- AI Yorum Çıkışı -->
    <div id="aiReadingContainer"></div>
  </div>

  <script>
    /************************************************************
     *         BILINGUAL TEXT & BASIC UI (NO STREAK)            *
     ************************************************************/
    const uiTexts = {
      en: {
        title: "Daily Tarot (No Streak/Limit)",
        subtitle: "Draw 3 cards anytime you like, then optionally get an AI interpretation. Test away!",
        drawButton: "Draw 3 Cards",
        aiButton: "AI Reading",
        synergyFallback: "",
        positionPast: "Past",
        positionPresent: "Present",
        positionFuture: "Future",
        aiReadingIntro: "Combining these cards, here's an AI reflection:"
      },
      tr: {
        title: "Günlük Tarot (Seri/Sınır Yok)",
        subtitle: "Dilediğiniz kadar 3 kart çekin, isterseniz yapay zekâ yorumunu alın. Test için ideal!",
        drawButton: "3 Kart Çek",
        aiButton: "AI Yorum",
        synergyFallback: "",
        positionPast: "Geçmiş",
        positionPresent: "Şimdi",
        positionFuture: "Gelecek",
        aiReadingIntro: "Bu kartları birleştirerek yapay zekâdan gelen yorum:"
      }
    };

    let currentLang = "en";

    const langToggleBtn = document.getElementById("langToggleBtn");
    const titleText = document.getElementById("titleText");
    const subtitleText = document.getElementById("subtitleText");
    const drawCardsBtn = document.getElementById("drawCardsBtn");
    const aiReadingBtn = document.getElementById("aiReadingBtn");
    const messageDiv = document.getElementById("message");
    const threeCardsContainer = document.getElementById("threeCardsContainer");
    const aiReadingContainer = document.getElementById("aiReadingContainer");

    function applyLanguage() {
      const t = uiTexts[currentLang];
      titleText.textContent = t.title;
      subtitleText.textContent = t.subtitle;
      drawCardsBtn.textContent = t.drawButton;
      aiReadingBtn.textContent = t.aiButton;
    }

    function toggleLanguage(){
      currentLang = (currentLang==="en") ? "tr" : "en";
      applyLanguage();
      if(drewCards) {
        // eğer AI'yı tekrar güncellemek isterseniz dil değişiminde
        // prompt'u tekrar yollayabilirsiniz. Burada yapmıyoruz, isterseniz ekleyin.
      }
    }
    langToggleBtn.addEventListener("click", toggleLanguage);

    // Başlangıç dil ayarını uygula
    applyLanguage();

    /************************************************************
     *                TAROT DECK (78, 24 local)                 *
     *   Not repeating the entire deck for brevity.  EXAMPLE.   *
     ************************************************************/
    const tarotDeck = [
      {
        name: "Two of Wands",
        image: "images/twoofwands.jpg",
        upright: {
          en: "Standing at a threshold, planning for the future. Bold action awaits.",
          tr: "Bir eşikte durma, gelecek planları. Cesur adımlar sizi bekliyor."
        },
        reversed: {
          en: "Indecision stalls your progress; weigh your options carefully.",
          tr: "Karar verememe ilerlemeyi durduruyor; seçenekleri dikkatlice tartın."
        }
      },
      {
        name: "Ace of Cups",
        image: "images/aceofcups.jpg",
        upright: {
          en: "A surge of emotion or creativity flows freely. Embrace heartfelt connections.",
          tr: "Duygusal veya yaratıcı bir akış serbest kaldı. Samimi bağları kucaklayın."
        },
        reversed: {
          en: "Unspoken feelings block deeper intimacy; resolve old pains.",
          tr: "Dile gelmemiş duygular daha derin yakınlığı engelliyor; eski yaraları çözün."
        }
      },
      {
        name: "The Chariot",
        image: "images/thechariot.jpg",
        upright: {
          en: "Willpower and discipline drive you onward to success.",
          tr: "İrade ve disiplin sizi başarıya doğru sürüklüyor."
        },
        reversed: {
          en: "Scattered forces or wavering focus halt your journey. Regain control.",
          tr: "Dağınık güçler veya dalgalanan odak yolculuğu durdurur. Kontrolü tekrar kazanın."
        }
      },
      {
        name: "Ace of Swords",
        image: "https://upload.wikimedia.org/wikipedia/commons/1/1b/Swords01.jpg",
        upright: {
          en: "A clear new idea or truth cuts through confusion. Use it wisely.",
          tr: "Net bir fikir veya gerçek karmaşayı keser. Bunu akıllıca kullanın."
        },
        reversed: {
          en: "Clouded perception or misused logic breeds tension.",
          tr: "Bulanık algı veya yanlış kullanılan mantık gerginlik yaratır."
        }
      }
      // ... Kalan 74 kart
    ];

    /************************************************************
     *                 DRAW LOGIC (NO DAILY LIMIT)              *
     ************************************************************/
    let drewCards = false;
    let chosenCards = [];

    drawCardsBtn.addEventListener("click", () => {
      messageDiv.textContent = "";
      threeCardsContainer.innerHTML="";
      aiReadingContainer.style.display="none";
      aiReadingContainer.textContent="";
      aiReadingBtn.style.display="none";

      // pick 3
      const idxSet = new Set();
      while(idxSet.size<3) {
        idxSet.add(Math.floor(Math.random()*tarotDeck.length));
      }
      const chosenIdx = [...idxSet].sort((a,b)=>a-b);

      const t = uiTexts[currentLang];
      const posLabels = [t.positionPast, t.positionPresent, t.positionFuture];
      const results = [];

      chosenIdx.forEach((deckI,i)=>{
        const card = tarotDeck[deckI];
        const isRev = Math.random()<0.5;

        const cardDiv = document.createElement("div");
        cardDiv.className="card-container";

        const label = document.createElement("h4");
        label.className="position-label";
        label.textContent=posLabels[i];
        cardDiv.appendChild(label);

        const imgEl = document.createElement("img");
        imgEl.src=card.image;
        if(isRev) imgEl.style.transform="rotate(180deg)";
        cardDiv.appendChild(imgEl);

        const title = document.createElement("h5");
        title.className="card-title";
        title.textContent = card.name + (isRev ? " (Reversed)":"");
        cardDiv.appendChild(title);

        const desc = document.createElement("p");
        desc.className="card-desc";
        desc.textContent = isRev
          ? card.reversed[currentLang]
          : card.upright[currentLang];
        cardDiv.appendChild(desc);

        threeCardsContainer.appendChild(cardDiv);

        results.push({name: card.name, isReversed: isRev});
      });

      drewCards = true;
      chosenCards = results;
      aiReadingBtn.style.display="inline-block"; // now can do AI reading
    });

    /************************************************************
     *                   AI READING LOGIC                       *
     ************************************************************/
    aiReadingBtn.addEventListener("click", async ()=>{
      if(!drewCards) return;
      aiReadingContainer.style.display="block";
      aiReadingContainer.textContent="...";

      try {
        const aiText = await doAIRequest(chosenCards, currentLang);
        const t = uiTexts[currentLang];
        aiReadingContainer.textContent = t.aiReadingIntro + "\n\n" + aiText;
      } catch(err){
        aiReadingContainer.textContent="AI request failed: " + err.message;
      }
    });

    // Basit Prompt
    function buildPrompt(cards, lang){
      const cList = cards.map(c=>{
        let rTag = c.isReversed ? (lang==="en"?"(Reversed)":"(Ters)") : "";
        return `- ${c.name} ${rTag}`;
      }).join("\n");
      if(lang==="en"){
        return `Below are 3 tarot cards the user has drawn:\n${cList}\n
You are an expert tarot reader. Provide a cohesive interpretation for the user, focusing on practical and emotional insights. Write in a supportive tone.`;
      } else {
        return `İşte kullanıcının çektiği 3 kart:\n${cList}\n
Sen uzman bir tarot okuyucususun. Kullanıcıya yönelik bütüncül bir yorum yap, pratik ve duygusal çıkarımlara odaklan. Destekleyici bir üslup kullan.`;
      }
    }

    // AI istek fonksiyonu (DEMO: front-end => openAI)
    async function doAIRequest(cards, lang) {
      const prompt = buildPrompt(cards, lang);
      // Burada API key front-end'de gömülü, GÜVENLİ DEĞİL
      const apiKey = "YOUR_OPENAI_API_KEY";

      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type":"application/json",
          "Authorization": `Bearer ${apiKey}`
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [
            {
              role: "system",
              content: (lang==="en")
                ? "You are an expert tarot reader, providing supportive insights."
                : "Uzman bir tarot okuyucususun, destekleyici içgörüler sunuyorsun."
            },
            {
              role: "user",
              content: prompt
            }
          ],
          max_tokens: 700,
          temperature: 0.9
        })
      });
      const data = await response.json();
      return data.choices?.[0]?.message?.content || "";
    }
  </script>
</body>
</html>
